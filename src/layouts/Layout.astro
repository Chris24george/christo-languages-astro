---
// You can import components or define variables here if needed
const siteTitle = "ChristoLanguages";
import '../styles/global.css';
import ThemeToggle from '../components/ThemeToggle.astro';
// Removed NewsletterSignup import
---
<!doctype html>
<html lang="en" class="scroll-smooth">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<link rel="icon" type="image/svg+xml" href="/favicon.svg" />
		<meta name="generator" content={Astro.generator} />

		<!-- Google Fonts Import -->
		<link rel="preconnect" href="https://fonts.googleapis.com">
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
		<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">

		<!-- Theme System Preference Handler (invisible) -->
		<ThemeToggle />

		<title>{siteTitle}</title>
	</head>
	<body 
        class="text-foreground font-sans flex flex-col min-h-screen transition-colors duration-200 ease-in-out"
    >
		<!-- Removed Overlay -->

		<header class="sticky top-0 z-50 w-full backdrop-blur-xl bg-header-bg/50 border-b border-border/20 transition-all duration-300 ease-in-out">
			<div class="container mx-auto flex h-16 items-center justify-between px-4">
				<a href="/" class="font-serif text-2xl font-bold text-primary tracking-wide flex items-center gap-2 transition-transform hover:scale-105 duration-300">{siteTitle}</a>

                <div class="flex items-center gap-4">
                    {/* Desktop Nav */} 
                    <nav 
                        id="desktop-nav" 
                        class="hidden md:block"
                    >
                        <ul class="flex items-center space-x-1">
                            <li>
                                <a href="/" class="px-3 py-2 text-sm font-medium rounded-full hover:bg-primary/10 hover:text-primary transition-all duration-300 ease-in-out" data-astro-prefetch>Home</a>
                            </li>
                            <li>
                                <a href="/blog" class="px-3 py-2 text-sm font-medium rounded-full hover:bg-primary/10 hover:text-primary transition-all duration-300 ease-in-out" data-astro-prefetch>Blog</a>
                            </li>
                            <li>
                                <a href="/shop" class="px-3 py-2 text-sm font-medium rounded-full hover:bg-primary/10 hover:text-primary transition-all duration-300 ease-in-out" data-astro-prefetch>Shop</a>
                            </li>
                            <li>
                                <a href="/app" class="px-3 py-2 text-sm font-medium rounded-full hover:bg-primary/10 hover:text-primary transition-all duration-300 ease-in-out" data-astro-prefetch>App</a>
                            </li>
                            <li>
                                <a href="/coaching" class="px-3 py-2 text-sm font-medium rounded-full hover:bg-primary/10 hover:text-primary transition-all duration-300 ease-in-out" data-astro-prefetch>Coaching</a>
                            </li>
                        </ul>
                    </nav>

                    {/* Removed Theme Toggle Button */}

                    {/* Mobile Nav Toggle */} 
                    <button id="nav-toggle" class="md:hidden inline-flex items-center justify-center text-primary transition-all duration-300 ease-in-out" aria-label="Toggle navigation" aria-expanded="false" aria-controls="mobile-nav">
                        <div class="w-6 h-6 flex flex-col justify-center items-center relative">
                            <span class="hamburger-line top block w-5 h-[2px] bg-current rounded absolute transform transition-transform duration-300 ease-in-out"></span>
                            <span class="hamburger-line middle block w-5 h-[2px] bg-current rounded absolute transform transition-opacity duration-300 ease-in-out"></span>
                            <span class="hamburger-line bottom block w-5 h-[2px] bg-current rounded absolute transform transition-transform duration-300 ease-in-out"></span>
                        </div>
                        <span class="sr-only">Menu</span>
                    </button>
                </div>
			</div>
            
            {/* Mobile Nav Menu - Separate from desktop nav */}
            <div 
                id="mobile-nav"
                class="md:hidden fixed inset-x-0 top-16 p-4 bg-card shadow-lg border-b border-border/10 transform origin-top transition-all duration-300 ease-out opacity-0 scale-95 -translate-y-4 pointer-events-none z-40"
            >
                <nav class="container mx-auto">
                    <ul class="flex flex-col space-y-2 py-1">
                        <li>
                            <a href="/" class="flex items-center pr-4 pl-4 py-3 text-base font-medium rounded-lg hover:bg-primary/5 hover:text-primary transition-all duration-300 ease-out hover:pl-6" data-astro-prefetch>
                                <span>Home</span>
                            </a>
                        </li>
                        <li>
                            <a href="/blog" class="flex items-center pr-4 pl-4 py-3 text-base font-medium rounded-lg hover:bg-primary/5 hover:text-primary transition-all duration-300 ease-out hover:pl-6" data-astro-prefetch>
                                <span>Blog</span>
                            </a>
                        </li>
                        <li>
                            <a href="/shop" class="flex items-center pr-4 pl-4 py-3 text-base font-medium rounded-lg hover:bg-primary/5 hover:text-primary transition-all duration-300 ease-out hover:pl-6" data-astro-prefetch>
                                <span>Shop</span>
                            </a>
                        </li>
                        <li>
                            <a href="/app" class="flex items-center pr-4 pl-4 py-3 text-base font-medium rounded-lg hover:bg-primary/5 hover:text-primary transition-all duration-300 ease-out hover:pl-6" data-astro-prefetch>
                                <span>App</span>
                            </a>
                        </li>
                        <li class="pt-1">
                            <a href="/coaching" class="flex items-center pr-4 pl-4 py-3 text-base font-medium rounded-lg hover:bg-primary/5 hover:text-primary transition-all duration-300 ease-out hover:pl-6" data-astro-prefetch>
                                <span>Coaching</span>
                            </a>
                        </li>
                    </ul>
                </nav>
            </div>
		</header>
		<main class="flex-grow container mx-auto p-4 md:p-8">
			<slot />
		</main>
		<footer class="bg-card text-foreground/80 text-sm border-t border-border mt-auto py-6 px-4">
          <div class="container mx-auto flex flex-col md:flex-row justify-between items-center gap-4">
            <p class="text-center md:text-left text-foreground/80">&copy; {new Date().getFullYear()} {siteTitle}. All rights reserved.</p>
            <nav>
              <ul class="flex flex-wrap justify-center md:justify-end gap-x-4 gap-y-2">
                <li><a href="/blog" class="text-foreground/80 hover:text-primary transition-colors">Blog</a></li>
                <li><a href="/shop" class="text-foreground/80 hover:text-primary transition-colors">Shop</a></li>
                <li><a href="/app" class="text-foreground/80 hover:text-primary transition-colors">App</a></li>
                <li><a href="/coaching" class="text-foreground/80 hover:text-primary transition-colors">Coaching</a></li>
                <li><a href="/privacy-policy" class="text-foreground/80 hover:text-primary transition-colors">Privacy Policy</a></li>
                {/* Add other links like Privacy Policy, Terms, etc. if needed */}
              </ul>
            </nav>
          </div>
		</footer>
	</body>
</html>

<style>
    html {
      overflow-y: scroll;
    }
</style>

<script is:inline>
  // Mobile Menu Script
  function setupMobileMenu() {
    const navToggle = document.getElementById('nav-toggle');
    const mobileNav = document.getElementById('mobile-nav');
    const hamburgerLines = navToggle ? {
        top: navToggle.querySelector('.hamburger-line.top'),
        middle: navToggle.querySelector('.hamburger-line.middle'),
        bottom: navToggle.querySelector('.hamburger-line.bottom'),
    } : null;

    // Initialize hamburger lines position
    if (hamburgerLines) {
      hamburgerLines.top.style.transform = 'translateY(-6px)';
      hamburgerLines.bottom.style.transform = 'translateY(6px)';
    }

    // Add active link highlighting
    function highlightActiveLink() {
      const currentPath = window.location.pathname;
      // For desktop nav
      const desktopLinks = document.querySelectorAll("#desktop-nav a");
      
      desktopLinks.forEach(link => {
        const linkPath = link.getAttribute('href');
        // Remove existing active classes first
        link.classList.remove('bg-primary/10', 'text-primary');
        
        // Skip the coaching link as it has its own styling
        if (link.href.includes('/coaching')) return;
        
        // Check if this link matches the current path
        if (currentPath === linkPath || 
            (linkPath !== '/' && currentPath.startsWith(linkPath))) {
          link.classList.add('bg-primary/10', 'text-primary');
        }
      });
      
      // For mobile nav
      const mobileLinks = document.querySelectorAll("#mobile-nav a");
      
      mobileLinks.forEach(link => {
        const linkPath = link.getAttribute('href');
        // Remove existing active classes first
        link.classList.remove('bg-primary/10', 'text-primary');
        
        // Skip the coaching link as it has its own styling
        if (link.href.includes('/coaching')) return;
        
        // Check if this link matches the current path
        if (currentPath === linkPath || 
            (linkPath !== '/' && currentPath.startsWith(linkPath))) {
          link.classList.add('bg-primary/10', 'text-primary');
        }
      });
    }

    function toggleMenu(show) {
        if (!mobileNav || !navToggle || !hamburgerLines) return;
        
        const expanded = show;
        navToggle.setAttribute('aria-expanded', String(expanded));

        if (expanded) {
            mobileNav.classList.remove('opacity-0', 'scale-95', '-translate-y-4', 'pointer-events-none');
            mobileNav.classList.add('opacity-100', 'scale-100', 'translate-y-0', 'pointer-events-auto');
            hamburgerLines.top.style.transform = 'rotate(45deg)';
            hamburgerLines.middle.style.opacity = '0';
            hamburgerLines.bottom.style.transform = 'rotate(-45deg)';
        } else {
            mobileNav.classList.add('opacity-0', 'scale-95', '-translate-y-4', 'pointer-events-none');
            mobileNav.classList.remove('opacity-100', 'scale-100', 'translate-y-0', 'pointer-events-auto');
            hamburgerLines.top.style.transform = 'translateY(-6px)';
            hamburgerLines.middle.style.opacity = '1';
            hamburgerLines.bottom.style.transform = 'translateY(6px)';
        }
    }

    if (navToggle && mobileNav && hamburgerLines) {
        const clickHandler = (e) => {
            e.stopPropagation(); 
            const isExpanded = navToggle.getAttribute('aria-expanded') === 'true';
            toggleMenu(!isExpanded);
        };
        const outsideClickHandler = (e) => {
            const isMenuOpen = navToggle.getAttribute('aria-expanded') === 'true';
            const isClickOutside = !navToggle.contains(e.target) && !mobileNav.contains(e.target);
            if (isMenuOpen && isClickOutside) {
                toggleMenu(false);
            }
        };
        const escapeHandler = (e) => {
            if (e.key === 'Escape' && navToggle.getAttribute('aria-expanded') === 'true') {
                toggleMenu(false);
            }
        };

        // Clean up previous listeners before adding new ones
        navToggle.removeEventListener('click', clickHandler);
        document.removeEventListener('click', outsideClickHandler);
        document.removeEventListener('keydown', escapeHandler);
        
        navToggle.addEventListener('click', clickHandler);
        document.addEventListener('click', outsideClickHandler);
        document.addEventListener('keydown', escapeHandler);
    }
    
    // Call the highlight function
    highlightActiveLink();
  }

  // Setup Function called on Astro events
  function initializePageScripts() {
      setupMobileMenu();
  }

  // Run scripts on initial load
  if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initializePageScripts, { once: true });
  } else {
      initializePageScripts(); // Already loaded
  }
</script>
