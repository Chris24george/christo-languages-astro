---
import { getCollection, type CollectionEntry } from 'astro:content';
import Layout from '../../layouts/Layout.astro';

// Get all entries from the `blog` collection
const posts = (await getCollection('blog')).sort(
    (a: CollectionEntry<'blog'>, b: CollectionEntry<'blog'>) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf()
);
---

<Layout title="ChristoLanguage Blog">
    <h1 class="text-4xl md:text-5xl font-serif font-bold text-foreground mb-10 text-center">Blog</h1>
    <div class="max-w-4xl mx-auto">
        <ul class="space-y-8">
            {posts.map((post: CollectionEntry<'blog'>) => (
                <li class="bg-card text-card-foreground border border-border p-6 rounded-lg transition-shadow hover:shadow-md">
                    <a href={`/blog/${post.slug}/`} class="block">
                        <h2 class="text-2xl md:text-3xl font-serif font-semibold text-foreground mb-3">{post.data.title}</h2>
                        <p class="text-foreground/90 mb-4">{post.data.description}</p>
                        <p class="text-sm text-foreground/80 mb-4">
                            Published on: {post.data.pubDate.toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}
                        </p>
                        {post.data.tags && (
                            <div class="flex flex-wrap gap-2">
                                {post.data.tags.map((tag: string) => (
                                    <span class="bg-muted text-muted-foreground text-xs font-medium px-2.5 py-0.5 rounded-full">{tag}</span>
                                ))}
                            </div>
                        )}
                    </a>
                </li>
            ))}
        </ul>
    </div>
</Layout> 